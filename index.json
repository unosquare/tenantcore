{
  "README.html": {
    "href": "README.html",
    "title": "TenantCore | TenantCore",
    "keywords": "TenantCore TenantCore is an OWIN Middleware that it can help to resolve tenants, a multitenancy middleware, by request's hostname for example or by any resolver. You can create your own Tenant's resolver or use the default one. The tenant can have a database connection string or any property that you need. To start you need to setup the Resolver and Tenants in your OWIN AppBuilder, for example: public void ConfigureAuth(IAppBuilder app) { // SetUp Multitenancy with TenantCore var tenants = new List<ITenant> { new Tenant(\"local\", \"localhost\", @\"Data Source=(LocalDb)\\v11.0;AttachDbFilename=|DataDirectory|\\local.mdf;Initial Catalog=local;Integrated Security=True\"), new Tenant(\"sample\", \"sample.local\", @\"Data Source=(LocalDb)\\v11.0;AttachDbFilename=|DataDirectory|\\sample.mdf;Initial Catalog=sample;Integrated Security=True\"), new Tenant(\"fake\", \"fake.local\", @\"Data Source=(LocalDb)\\v11.0;AttachDbFilename=|DataDirectory|\\fake.mdf;Initial Catalog=fake;Integrated Security=True\") }; app.UseTenantCore(new HostNameTenantResolver(tenants)); // Configure the db context and user manager to use a single instance per request app.CreatePerOwinContext<ApplicationDbContext>(ApplicationDbContext.Create); app.CreatePerOwinContext<ApplicationUserManager>(ApplicationUserManager.Create); // And continue with your middleware and settings } If you want to have a database per tenant, you need to change your DbContext or IdentityDbContext to have a Create method with parameters: public static ApplicationDbContext Create(IdentityFactoryOptions<ApplicationDbContext> options, IOwinContext context) { return context.GetDbContext<ApplicationDbContext>(); } The GetDbContext is an extension method in TenantCore, it will find the current Tenant and get the ConnectionString. The ConnectionString will be used with your DbContext, so be sure to have a constructor with connectionstring param like this: public ApplicationDbContext(string connectionString) : base(connectionString, throwIfV1Schema: false) {} Now in your ApiController you can use the Tenant or DbContext with some extension methods, for example: [HttpGet, Route(\"register/{id}\")] public async Task<IHttpActionResult> Register(string id) { // Gets the DbContext related to current Tenant var database = HttpContext.Current.GetDbContext<ApplicationDbContext>(); // Gets the current Tenant var tenant = HttpContext.Current.GetCurrentTenant(); }"
  },
  "api/Unosquare.TenantCore.ITenantResolver.html": {
    "href": "api/Unosquare.TenantCore.ITenantResolver.html",
    "title": "Interface ITenantResolver | TenantCore",
    "keywords": "Interface ITenantResolver Public Tenant Resolver interface Namespace : Unosquare.TenantCore Syntax public interface ITenantResolver Properties DatabaseIdentifier Gets the Database Identifier, for example if your tables contains TenantId column, this is your Identifier Declaration string DatabaseIdentifier { get; } Property Value Type Description System.String Methods GetTenants() Retrieves the Tenants in the resolver Declaration List<ITenant> GetTenants() Returns Type Description System.Collections.Generic.List < ITenant > The Tenant's list Resolve(IOwinRequest) This method should take a Owin Request and resolve the possible Tenant Declaration ITenant Resolve(IOwinRequest request) Parameters Type Name Description IOwinRequest request The request Returns Type Description ITenant The tenant Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.RouteTenantResolver.html": {
    "href": "api/Unosquare.TenantCore.RouteTenantResolver.html",
    "title": "Class RouteTenantResolver | TenantCore",
    "keywords": "Class RouteTenantResolver You need to setup your route like \"api/{tenant}/{controller}/{id}\" in order to receive the Tenant value. Inheritance System.Object TenantResolverBase RouteTenantResolver Implements ITenantResolver Inherited Members TenantResolverBase.Tenants TenantResolverBase.Add(ITenant) TenantResolverBase.GetTenants() TenantResolverBase.DatabaseIdentifier System.Object.ToString() System.Object.Equals(System.Object) System.Object.Equals(System.Object, System.Object) System.Object.ReferenceEquals(System.Object, System.Object) System.Object.GetHashCode() System.Object.GetType() System.Object.MemberwiseClone() Namespace : Unosquare.TenantCore Syntax public class RouteTenantResolver : TenantResolverBase, ITenantResolver Constructors RouteTenantResolver(IEnumerable<ITenant>, String) Instances a new resolver with a tenant list Declaration public RouteTenantResolver(IEnumerable<ITenant> tenants, string databaseIdentifier = null) Parameters Type Name Description System.Collections.Generic.IEnumerable < ITenant > tenants The list of tenants System.String databaseIdentifier The Database Identifier Fields RouteName Defines the RouteName identifier Declaration public const string RouteName = \"tenant\" Field Value Type Description System.String Methods Resolve(IOwinRequest) Resolves a tenant request using hostname Declaration public ITenant Resolve(IOwinRequest request) Parameters Type Name Description IOwinRequest request The request Returns Type Description ITenant The tenant or null Implements ITenantResolver Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.TenantResolverBase.html": {
    "href": "api/Unosquare.TenantCore.TenantResolverBase.html",
    "title": "Class TenantResolverBase | TenantCore",
    "keywords": "Class TenantResolverBase Base Tenant Resolver functionality with internal Tenant List Inheritance System.Object TenantResolverBase HostNameTenantResolver RouteTenantResolver Inherited Members System.Object.ToString() System.Object.Equals(System.Object) System.Object.Equals(System.Object, System.Object) System.Object.ReferenceEquals(System.Object, System.Object) System.Object.GetHashCode() System.Object.GetType() System.Object.MemberwiseClone() Namespace : Unosquare.TenantCore Syntax public abstract class TenantResolverBase Constructors TenantResolverBase(IEnumerable<ITenant>, String) Instances a new resolver with a tenant list Declaration protected TenantResolverBase(IEnumerable<ITenant> tenants, string databaseIdentifier = null) Parameters Type Name Description System.Collections.Generic.IEnumerable < ITenant > tenants The list of tenants System.String databaseIdentifier The Database Identifier TenantResolverBase(String) Instances a new Resolver without tenants Declaration protected TenantResolverBase(string databaseIdentifier = null) Parameters Type Name Description System.String databaseIdentifier The Database Identifier Fields Tenants The Tenants repository Declaration protected List<ITenant> Tenants Field Value Type Description System.Collections.Generic.List < ITenant > Properties DatabaseIdentifier Retrieves the Database Identifier Declaration public string DatabaseIdentifier { get; } Property Value Type Description System.String Methods Add(ITenant) Adds a new tenant to resolver Declaration public void Add(ITenant tenant) Parameters Type Name Description ITenant tenant The tenant instance GetTenants() Retrieves the Tenants in the resolver Declaration public List<ITenant> GetTenants() Returns Type Description System.Collections.Generic.List < ITenant > The Tenant's list Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.HostNameTenantResolver.html": {
    "href": "api/Unosquare.TenantCore.HostNameTenantResolver.html",
    "title": "Class HostNameTenantResolver | TenantCore",
    "keywords": "Class HostNameTenantResolver Tenant Resolver class using request's hostname as key to find a possible Tenant Inheritance System.Object TenantResolverBase HostNameTenantResolver Implements ITenantResolver Inherited Members TenantResolverBase.Tenants TenantResolverBase.Add(ITenant) TenantResolverBase.GetTenants() TenantResolverBase.DatabaseIdentifier System.Object.ToString() System.Object.Equals(System.Object) System.Object.Equals(System.Object, System.Object) System.Object.ReferenceEquals(System.Object, System.Object) System.Object.GetHashCode() System.Object.GetType() System.Object.MemberwiseClone() Namespace : Unosquare.TenantCore Syntax public class HostNameTenantResolver : TenantResolverBase, ITenantResolver Constructors HostNameTenantResolver(IEnumerable<ITenant>, String) Instances a new resolver with a tenant list Declaration public HostNameTenantResolver(IEnumerable<ITenant> tenants, string databaseIdentifier = null) Parameters Type Name Description System.Collections.Generic.IEnumerable < ITenant > tenants The list of tenants System.String databaseIdentifier The Database Identifier HostNameTenantResolver(String) Instances a new Resolver without tenants Declaration public HostNameTenantResolver(string databaseIdentifier = null) Parameters Type Name Description System.String databaseIdentifier The Database Identifier Methods Resolve(IOwinRequest) Resolves a tenant request using hostname Declaration public ITenant Resolve(IOwinRequest request) Parameters Type Name Description IOwinRequest request The request Returns Type Description ITenant The tenant or null Implements ITenantResolver Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.ITenant.html": {
    "href": "api/Unosquare.TenantCore.ITenant.html",
    "title": "Interface ITenant | TenantCore",
    "keywords": "Interface ITenant Public interface to create Tenant instances Namespace : Unosquare.TenantCore Syntax public interface ITenant Properties ConnectionString The Tenant connection string Declaration string ConnectionString { get; } Property Value Type Description System.String Domain The Tenant domains Declaration string Domain { get; } Property Value Type Description System.String Id Tenant's Id Declaration long Id { get; } Property Value Type Description System.Int64 Name Tenant's name Declaration string Name { get; } Property Value Type Description System.String Properties Properties collection Declaration Dictionary<string, string> Properties { get; } Property Value Type Description System.Collections.Generic.Dictionary < System.String , System.String > Resolver The Resolver instance Declaration ITenantResolver Resolver { get; set; } Property Value Type Description ITenantResolver Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.OwinExtensions.html": {
    "href": "api/Unosquare.TenantCore.OwinExtensions.html",
    "title": "Class OwinExtensions | TenantCore",
    "keywords": "Class OwinExtensions Extensions methods Inheritance System.Object OwinExtensions Inherited Members System.Object.ToString() System.Object.Equals(System.Object) System.Object.Equals(System.Object, System.Object) System.Object.ReferenceEquals(System.Object, System.Object) System.Object.GetHashCode() System.Object.GetType() System.Object.MemberwiseClone() Namespace : Unosquare.TenantCore Syntax public static class OwinExtensions Methods GetCurrentTenant(HttpContext) Retrieves the current Tenant from a HttpContext Declaration public static ITenant GetCurrentTenant(this HttpContext context) Parameters Type Name Description HttpContext context The Http context Returns Type Description ITenant The Tenant Exceptions Type Condition System.ArgumentNullException GetCurrentTenant(IOwinContext) Retrieves the current Tenant from a Owin Context Declaration public static ITenant GetCurrentTenant(this IOwinContext context) Parameters Type Name Description IOwinContext context The Owin context Returns Type Description ITenant The Tenant Exceptions Type Condition System.ArgumentNullException GetDbContext<T>(HttpContext) Retrieves the current database (using Tenant Connectionstring) Declaration public static T GetDbContext<T>(this HttpContext context) where T : class Parameters Type Name Description HttpContext context The Http Context Returns Type Description T A DbContext Type Parameters Name Description T The DbContext Type Exceptions Type Condition System.ArgumentNullException GetDbContext<T>(IOwinContext) Retrieves the current database (using Tenant Connectionstring) Declaration public static T GetDbContext<T>(this IOwinContext context) where T : class Parameters Type Name Description IOwinContext context The Owin Context Returns Type Description T A DbContext Type Parameters Name Description T The DbContext Type Exceptions Type Condition System.ArgumentNullException GetDbSet<T>(DbContext, HttpContext) Retrieves a filtered DbSet by the current Tenant Declaration public static IQueryable<T> GetDbSet<T>(this DbContext context, HttpContext httpContext) where T : class Parameters Type Name Description DbContext context The DbContext HttpContext httpContext The Http Context Returns Type Description IQueryable <T> The filtered Dbset Type Parameters Name Description T The DbSet type Exceptions Type Condition System.ArgumentNullException UseTenantCore(IAppBuilder, ITenantResolver, Func<ITenant, Boolean>) Add TenantCore to an AppBuilder Declaration public static IAppBuilder UseTenantCore(this IAppBuilder app, ITenantResolver resolver, Func<ITenant, bool> callback = null) Parameters Type Name Description IAppBuilder app The AppBuilder instance ITenantResolver resolver The Tenant Resolver instance System.Func < ITenant , System.Boolean > callback The callback method Returns Type Description IAppBuilder AppBuilder with TenantCore Exceptions Type Condition System.ArgumentNullException Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.TenantCoreMiddleware.html": {
    "href": "api/Unosquare.TenantCore.TenantCoreMiddleware.html",
    "title": "Class TenantCoreMiddleware | TenantCore",
    "keywords": "Class TenantCoreMiddleware Owin Middlware to connect TenantCore to Owin Inheritance System.Object TenantCoreMiddleware Namespace : Unosquare.TenantCore Syntax public class TenantCoreMiddleware : OwinMiddleware Constructors TenantCoreMiddleware(OwinMiddleware, ITenantResolver, Func<ITenant, Boolean>) Initialize the Middleware with a Tenant's resolver Declaration public TenantCoreMiddleware(OwinMiddleware next, ITenantResolver resolver, Func<ITenant, bool> callback = null) Parameters Type Name Description OwinMiddleware next The next Middleware ITenantResolver resolver The Tenant's resolver System.Func < ITenant , System.Boolean > callback The Callback action Fields Callback The Callback Declaration protected Func<ITenant, bool> Callback Field Value Type Description System.Func < ITenant , System.Boolean > OwinPropertyName Environment variable name Declaration public static string OwinPropertyName Field Value Type Description System.String Resolver The Tenant Resolver Declaration protected ITenantResolver Resolver Field Value Type Description ITenantResolver Methods Invoke(IOwinContext) Method to receive a new request Declaration public override Task Invoke(IOwinContext context) Parameters Type Name Description IOwinContext context The OWIN Context Returns Type Description System.Threading.Tasks.Task The next Task Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.html": {
    "href": "api/Unosquare.TenantCore.html",
    "title": "Namespace Unosquare.TenantCore | TenantCore",
    "keywords": "Namespace Unosquare.TenantCore Classes HostNameTenantResolver Tenant Resolver class using request's hostname as key to find a possible Tenant OwinExtensions Extensions methods RouteTenantResolver You need to setup your route like \"api/{tenant}/{controller}/{id}\" in order to receive the Tenant value. Tenant Represents a common Tenant TenantCoreMiddleware Owin Middlware to connect TenantCore to Owin TenantResolverBase Base Tenant Resolver functionality with internal Tenant List Interfaces ITenant Public interface to create Tenant instances ITenantResolver Public Tenant Resolver interface Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  },
  "api/Unosquare.TenantCore.Tenant.html": {
    "href": "api/Unosquare.TenantCore.Tenant.html",
    "title": "Class Tenant | TenantCore",
    "keywords": "Class Tenant Represents a common Tenant Inheritance System.Object Tenant Implements ITenant Inherited Members System.Object.ToString() System.Object.Equals(System.Object) System.Object.Equals(System.Object, System.Object) System.Object.ReferenceEquals(System.Object, System.Object) System.Object.GetHashCode() System.Object.GetType() System.Object.MemberwiseClone() Namespace : Unosquare.TenantCore Syntax public class Tenant : ITenant Constructors Tenant(Int64, String, String, String) Creates a new Tenant Declaration public Tenant(long id, string name, string domain, string connectionString = null) Parameters Type Name Description System.Int64 id The ID System.String name The name System.String domain The related Domain System.String connectionString Optional ConnectiongString Properties ConnectionString The Tenant connection string Declaration public string ConnectionString { get; } Property Value Type Description System.String Domain The Tenant domains Declaration public string Domain { get; } Property Value Type Description System.String Id Tenant's Id Declaration public long Id { get; } Property Value Type Description System.Int64 Name Tenant's name Declaration public string Name { get; } Property Value Type Description System.String Properties Properties collection Declaration public Dictionary<string, string> Properties { get; } Property Value Type Description System.Collections.Generic.Dictionary < System.String , System.String > Resolver The Resolver instance Declaration public ITenantResolver Resolver { get; set; } Property Value Type Description ITenantResolver Implements ITenant Comments /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = 'https://unolabs.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); Please enable JavaScript to view the comments powered by Disqus."
  }
}